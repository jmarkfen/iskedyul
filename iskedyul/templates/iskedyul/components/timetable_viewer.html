<div class="border border-secondary-subtle rounded rounded-3"  id="printableArea">
    <style>
        /* Add custom CSS for equal-width columns */
        .table-fixed {
            table-layout: fixed;
            width: 100%;
        }
        .table-fixed th, .table-fixed td {
            width: 20%; /* Set equal width for each column (adjust as needed) */
            text-align: center; /* Center-align text within cells */
        }
        .tbody-tr-fixed tr {
            height: 20px;
        }
    </style>
    <table class="table table-sm table-bordered border rounded overflow-hidden m-0 caption-top table-fixed">
        <caption class="text-center fw-bold">{{ timetable.title }}</caption>
        <thead>
            <tr>
                <th>TIME</th>
                {% for th in table.head %}<th scope="colgroup" colspan="{{ th.colspan }}">{{ th.day.label|upper }}</th>{% endfor %}
            </tr>
        </thead>
        <tbody class="tbody-tr-fixed">
            {% for interval, row in table.body.items %}
                <tr>
                    <th scope="row" class="fw-normal">{{ interval.start|time:"h:i" }}-{{ interval.end|time:'h:i A' }}</th>
                    {% for td in row %}
                        {% if td is not None %}
                            {% if td.empty %}
                                <td></td>
                            {% else %}
                                <td rowspan="{{ td.rowspan }}" class="bg-body-secondary">
                                    <a href="{% url 'edit_event' timetable.id td.event.id %}"
                                       class="link-underline link-underline-opacity-0">{{ td.event.text|linebreaks }}</a>
                                </td>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
<script>
    document.addEventListener("keydown", function(event) {
        // Check if Ctrl (or Cmd on Mac) and P keys are pressed simultaneously
        if ((event.ctrlKey || event.metaKey) && event.key === "p") {
            event.preventDefault(); // Prevent the default print dialog
            printTable();
        }
    });

    function addDPrintNoneToAllExceptTableAndElementsWithClass(className) {
        // Get all elements on the page
        const allElements = document.querySelectorAll("*");
      
        // Iterate over all elements
        for (const element of allElements) {
          // Check if the element is a table or a table element, or if it has the specified class name
          if (element.tagName !== "TABLE" && !element.closest("TABLE") && !element.classList.contains(className)) {
            // Add the "d-print-none" CSS class to the element
            element.classList.add("d-print-none");
          }
        }
      }
      
    
    function printTable() {
        var originalContents = document.body.innerHTML;
        var printContents = document.getElementById('printableArea').outerHTML;
        
        document.body.innerHTML = printContents;
        
        window.print();
        
        document.body.innerHTML = originalContents;
    }
</script>